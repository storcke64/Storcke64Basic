' Gambas class file

''' This virtual class represents the highlighting styles of the TextEditor.

Export

Event _Change

Private $aStyle As TextEditorStyle[]

Public Sub _new()

  Dim I As Integer
  
  $aStyle = New TextEditorStyle[32]
  
  ' $aStyle[Highlight.Background] = New TextEditorStyle(Color.White)
  ' $aStyle[Highlight.Normal] = New TextEditorStyle(Color.Black)
  ' $aStyle[Highlight.Keyword] = New TextEditorStyle(Color.Black, True)
  ' $aStyle[Highlight.Datatype] = New TextEditorStyle(&HDF6B00&, True)
  ' $aStyle[Highlight.Function] = New TextEditorStyle(&H3398C3&, True)
  ' $aStyle[Highlight.Operator] = New TextEditorStyle(Color.Black, True)
  ' $aStyle[Highlight.Symbol] = New TextEditorStyle(Color.Black)
  ' $aStyle[Highlight.Number] = New TextEditorStyle(&HFF0000&, True)
  ' $aStyle[Highlight.String] = New TextEditorStyle(&H7F0000&)
  ' $aStyle[Highlight.Comment] = New TextEditorStyle(&H888888&, False)
  ' $aStyle[Highlight.Help] = New TextEditorStyle(&H888888&, True)
  ' $aStyle[Highlight.Preprocessor] = New TextEditorStyle(&H006E28&, True)
  ' $aStyle[Highlight.Breakpoint] = New TextEditorStyle(&HFF5F5F&)
  ' $aStyle[Highlight.Current] = New TextEditorStyle(&H42C9FF&)
  ' $aStyle[Highlight.Selection] = New TextEditorStyle(&HC3EDFF&)
  ' $aStyle[Highlight.Highlight] = New TextEditorStyle(&H7FFF00&)
  ' $aStyle[Highlight.CurrentLine] = New TextEditorStyle(&HE7F3FF&)
  ' $aStyle[Highlight.Error] = New TextEditorStyle(&HBF0303&, False, True)
  ' $aStyle[Highlight.Escape] = New TextEditorStyle(&H7F0000&, True, False, True)
  ' $aStyle[Highlight.Label] = New TextEditorStyle(Color.Black, False, False, True)
  ' $aStyle[Highlight.Constant] = New TextEditorStyle(&HA00000&, True)
  ' $aStyle[Highlight.Alternate] = New TextEditorStyle(&HE0E0E0&)
  ' $aStyle[Highlight.Added] = New TextEditorStyle(&00FF00)
  ' $aStyle[Highlight.Removed] = New TextEditorStyle(&FF8080)

  $aStyle[Highlight.Background] = New TextEditorStyle(Color.TextBackground)
  $aStyle[Highlight.Normal] = New TextEditorStyle(Color.TextForeground)
  $aStyle[Highlight.Keyword] = New TextEditorStyle(Color.TextForeground, True)
  $aStyle[Highlight.Datatype] = New TextEditorStyle(&HDF6B00&, True)
  $aStyle[Highlight.Function] = New TextEditorStyle(&H3398C3&, True)
  $aStyle[Highlight.Operator] = New TextEditorStyle(Color.Black, True)
  $aStyle[Highlight.Symbol] = New TextEditorStyle(Color.Black)
  $aStyle[Highlight.Number] = New TextEditorStyle(&HFF0000&, True)
  $aStyle[Highlight.String] = New TextEditorStyle(&H7F0000&)
  $aStyle[Highlight.Comment] = New TextEditorStyle(&H888888&, False)
  $aStyle[Highlight.Help] = New TextEditorStyle(&H888888&, True)
  $aStyle[Highlight.Preprocessor] = New TextEditorStyle(&H006E28&, True)
  $aStyle[Highlight.Breakpoint] = New TextEditorStyle(&HFF5F5F&)
  $aStyle[Highlight.Current] = New TextEditorStyle(&H42C9FF&)
  $aStyle[Highlight.Selection] = New TextEditorStyle(Color.SelectedBackground)
  $aStyle[Highlight.Highlight] = New TextEditorStyle(&H6FE06F)
  $aStyle[Highlight.CurrentLine] = New TextEditorStyle(Color.LightBackground)
  $aStyle[Highlight.Error] = New TextEditorStyle(&HBF0303&, False, True)
  $aStyle[Highlight.Escape] = New TextEditorStyle(&H7F0000&, True, False, True)
  $aStyle[Highlight.Label] = New TextEditorStyle(Color.Black, False, False, True)
  $aStyle[Highlight.Constant] = New TextEditorStyle(&HA00000&, True)
  $aStyle[Highlight.Alternate] = New TextEditorStyle(&HE0E0E0&)
  $aStyle[Highlight.Added] = New TextEditorStyle(&00FF00)
  $aStyle[Highlight.Removed] = New TextEditorStyle(&FF8080)
  
  For I = Highlight.Custom To $aStyle.Max
    $aStyle[I] = New TextEditorStyle
  Next
  
  For I = 0 To $aStyle.Max
    Object.Attach($aStyle[I], Me, "Style")
  Next
  
End

Public Sub _GetStyles() As TextEditorStyle[]
  
  Return $aStyle
  
End

Public Sub _SetStyles(aStyle As TextEditorStyle[])
  
  Dim I As Integer
  
  $aStyle = New TextEditorStyle[aStyle.Count]
  For I = 0 To $aStyle.Max
    $aStyle[I] = aStyle[I].Copy()
    Object.Attach($aStyle[I], Me, "Style")
  Next
  
End

'' Return the highlighting style associated with a specific highlight constant.
''
'' - ~Style~ is one of the [/comp/gb.eval/highlight] constants.

Public Sub _get((Style) As Integer) As _TextEditorStyle

  Dim hStyle As TextEditorStyle
  
  Try hStyle = $aStyle[Style]
  If Not hStyle Then Error.Raise("Invalid argument")
  
  _TextEditorStyle._Style = hStyle
  Return _TextEditorStyle
  
End

Public Sub Style_Change()
  
  Raise _Change
  
End
